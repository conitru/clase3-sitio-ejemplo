---
title: "Gráficos estáticos e interactivos"
---

## Paquetes

```{r}
#| label: paquetes
#| echo: true
#| message: false
#| warning: false

library(ggplot2)
library(plotly)
library(dplyr)
library(lubridate)
```

Usaremos la base `mpg` que viene incluida en `ggplot2`.

---

## Gráfico estático

```{r}
#| label: grafico-estatico
#| echo: true
#| message: false
#| warning: false

# Datos de economía que vienen en ggplot2
datos_econ <- economics |>
  mutate(
    tasa_desemp = unemploy / pop * 100
  )

ggplot(datos_econ, aes(x = date, y = tasa_desemp)) +
  geom_line(color = "#2c3e50", linewidth = 0.6) +
  labs(
    title = "Tasa de desempleo estimada en el tiempo",
    subtitle = "Serie mensual (economics, ggplot2)",
    x = "Fecha",
    y = "Desempleo (% de la población)"
  ) +
  theme_minimal()
```

---

## Gráfico animado

```{r}
#| label: grafico-ggplotly
#| echo: true
#| message: false
#| warning: false

p_linea <- ggplot(datos_econ, aes(x = date, y = tasa_desemp)) +
  geom_line(linewidth = 0.6) +
  labs(
    title = "Tasa de desempleo estimada en el tiempo (interactivo)",
    x = "Fecha",
    y = "Desempleo (% de la población)"
  ) +
  theme_minimal()

plotly::ggplotly(p_linea)
```


## Densidades por clase (interactivo)

```{r}
#| label: densidad-ggplotly
#| echo: true
#| message: false
#| warning: false

datos_econ2 <- datos_econ |>
  mutate(
    decada = paste0(floor(year(date) / 10) * 10, "s")
  )

p_scatter <- ggplot(datos_econ2, aes(
  x = psavert,
  y = tasa_desemp,
  color = decada,
  text = paste(
    "Fecha:", date,
    "<br>Desempleo (%):", round(tasa_desemp, 1),
    "<br>Ahorro personal (% ingreso):", round(psavert, 1),
    "<br>Década:", decada
  )
)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "Relación entre desempleo y ahorro personal",
    subtitle = "Colores por década (economics, ggplot2)",
    x = "Ahorro personal (% del ingreso)",
    y = "Desempleo (% de la población)",
    color = "Década"
  ) +
  theme_minimal()

plotly::ggplotly(
  p_scatter,
  tooltip = "text"
)

```

